<!DOCTYPE html>
<html lang="en">

<head>
       <meta charset="UTF-8">
       <meta http-equiv="X-UA-Compatible" content="IE=edge">
       <meta name="viewport" content="width=device-width, initial-scale=1.0">
       <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
       <title>Document</title>
       <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
              integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT"
              crossorigin="anonymous">
       <!-- JavaScript Bundle with Popper -->
       <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"
              integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8"
              crossorigin="anonymous"></script>
       <!-- <script src="./script.js"></script> -->
</head>
<style>
       .btn-seach,
       .btn-filter {
              width: 165px !important;
       }

       #searchProduct {
              width: 332px !important;
       }

       /* [data-filter-item] {
              border: 1px solid #fff;
       } */

       .hidden {
              display: none;
       }

       input[type="checkbox"] {
              width: 12px;
              border: 1px solid red;
              height: 12px;
       }

       input.mycheckbox {
              width: 25px;
              border: 1px solid red;
              height: 25px;
       }

       /* button[disabled] {
              border: 1px solid yellow !important;
       } */
</style>

<body>
       <div class="container">
              <h2 class="display-2 m-3 font-bold text-center text-purple">Product Page</h2>
              <div class="container">
                     <div class="col-md-2 ms-auto d-flex justify-content-end">
                            <button class="btn btn-success my-2 d-flex gap-4 " id="btn-add-to-cart"> <span> My Cart
                                   </span> <span>
                                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                                 fill="currentColor" class="bi bi-cart" viewBox="0 0 16 16">
                                                 <path
                                                        d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l1.313 7h8.17l1.313-7H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z" />
                                          </svg>
                                   </span></button>

                     </div>
              </div>

              <form class="p-0 m-0 ">
                     <div class="form-group  row gap-1">
                            <div class="col-md-12 d-flex justify-content-between align-items-center">
                                   <div>
                                          <select class="form-select form-select-lg"
                                                 aria-label=".form-select-lg example">
                                                 <option selected>Choose your Category</option>
                                                 <option value="men's clothing">men's clothing</option>
                                                 <option value="women's clothing">women's clothing</option>
                                                 <option value="jewelery">jewelery</option>
                                                 <option value="electronics">electronics</option>

                                          </select>


                                   </div>
                                   <div class="d-flex justify-content-end gap-2">
                                          <input type="text" class="form-control" id="searchProduct"
                                                 placeholder="Search your product" data-search>
                                          <!-- <button type="submit" class="py-3 btn-seach btn btn-primary">Search</button> -->
                                          <a class="py-3 me-3 btn btn-primary btn-filter" data-bs-toggle="offcanvas"
                                                 href="#offcanvas" role="button">
                                                 Filter
                                          </a>
                                   </div>
                                   <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvas"
                                          aria-labelledby="offcanvasLabel">
                                          <div class="offcanvas-header">
                                                 <h2 class="offcanvas-title mt-2" id="offcanvasLabel">Filter Your Data
                                                 </h2>
                                                 <button type="button" class="btn-close text-reset"
                                                        data-bs-dismiss="offcanvas"></button>
                                          </div>
                                          <div class="offcanvas-body">
                                                 <div>
                                                        <div class="accordion" id="accordion">
                                                               <div class="accordion-item open">
                                                                      <h2 class="accordion-header" id="headingOne">
                                                                             <button class="accordion-button"
                                                                                    type="button"
                                                                                    data-bs-toggle="collapse"
                                                                                    data-bs-target="#collapseOne"
                                                                                    aria-expanded="true"
                                                                                    aria-controls="collapseOne">
                                                                                    Rating
                                                                             </button>
                                                                      </h2>
                                                                      <div id="collapseOne"
                                                                             class="accordion-collapse collapse show"
                                                                             aria-labelledby="headingOne"
                                                                             data-bs-parent="#accordion">
                                                                             <div class="accordion-body checkbox-list">
                                                                                    <div
                                                                                           class="d-flex align-items-center mt-2">
                                                                                           <input type="checkbox"
                                                                                                  class="mycheckbox"
                                                                                                  value="5" id="rate5">
                                                                                           <label for="rate5"
                                                                                                  class="form-label ms-3 mt-2 text-black-50">>5
                                                                                                  rating</label>
                                                                                    </div>
                                                                                    <div
                                                                                           class="d-flex align-items-center mt-2">
                                                                                           <input type="checkbox"
                                                                                                  class="mycheckbox"
                                                                                                  value="4" id="rate4">
                                                                                           <label for="rate4"
                                                                                                  class="form-label ms-3 mt-2 text-black-50">>4
                                                                                                  rating</label>
                                                                                    </div>
                                                                                    <div
                                                                                           class="d-flex align-items-center mt-2">
                                                                                           <input type="checkbox"
                                                                                                  class="mycheckbox"
                                                                                                  value="3" id="rate3">
                                                                                           <label for="rate3"
                                                                                                  class="form-label ms-3 mt-2 text-black-50">>3
                                                                                                  rating</label>
                                                                                    </div>
                                                                                    <div
                                                                                           class="d-flex align-items-center mt-2">
                                                                                           <input type="checkbox"
                                                                                                  class="mycheckbox"
                                                                                                  value="2" id="rate2">
                                                                                           <label for="rate2"
                                                                                                  class="form-label ms-3 mt-2 text-black-50">>2
                                                                                                  rating</label>
                                                                                    </div>
                                                                                    <div
                                                                                           class="d-flex align-items-center mt-2">
                                                                                           <input type="checkbox"
                                                                                                  class="mycheckbox"
                                                                                                  value="1" id="rate1">
                                                                                           <label for="rate1"
                                                                                                  class="form-label ms-3 mt-2 text-black-50">>1
                                                                                                  rating</label>
                                                                                    </div>

                                                                             </div>
                                                                      </div>
                                                               </div>
                                                               <div class="accordion-item ">
                                                                      <h2 class="accordion-header" id="headingTwo">
                                                                             <button class="accordion-button collapsed"
                                                                                    type="button"
                                                                                    data-bs-toggle="collapse"
                                                                                    data-bs-target="#collapseTwo"
                                                                                    aria-expanded="false"
                                                                                    aria-controls="collapseTwo">
                                                                                    Accordion Item #2
                                                                             </button>
                                                                      </h2>
                                                                      <div id="collapseTwo"
                                                                             class="accordion-collapse collapse"
                                                                             aria-labelledby="headingTwo"
                                                                             data-bs-parent="#accordion">
                                                                             <div class="accordion-body">
                                                                                    <div
                                                                                           class="d-flex flex-column align-items-center mt-2">
                                                                                           <label for="slider "
                                                                                                  class="form-label">Price
                                                                                                  Range</label>
                                                                                           <input type="range"
                                                                                                  class="form-range"
                                                                                                  min="0" max="1000"
                                                                                                  step="0.5" id="slider"
                                                                                                  class="myrange">
                                                                                    </div>
                                                                             </div>
                                                                      </div>
                                                               </div>
                                                        </div>
                                                 </div>
                                          </div>
                                   </div>
                            </div>

                     </div>

              </form>

              <div class="row p-0 mt-5" id="ItemWrapper">

              </div>
       </div>
       <script>
              var x = '';
              $(document).ready(function () {
                     jQuery.ajax({
                            url: "https://fakestoreapi.com/products",
                            type: "GET",
                            success: function (data) {
                                   x = data;
                                   adddata(data)
                                   function adddata(data) {
                                          $("#ItemWrapper").empty()
                                          $.each(data, function (key, item) {
                                                 console.log(item.length)
                                                 $("#ItemWrapper").append(`<div  class="col-sm-8 col-md-4 col-lg-3 col-12 p-2 d-flex justify-center">
                                                                      <div class="card mx-auto  m-2 Regular shadow border-none d-flex flex-column justify-between" style="width: 16rem;">
                                                                      <img src="${item.image}" class="card-img-top p-3" style="height:14rem !important"
                                                                      alt="...">
                                                                      <div class="card-body d-flex flex-column justify-between">
                                                                      <h1 class="font-bold fs-5 my-2">${(item.title).substring(0, 25)}...</h1>
                                                                      <p class="card-text">${(item.description).substring(0, 34)}...</p>
                                                                      <div class="flex justify-between items-center mt-1">

                                                                      <span class="font-bold fs-5">${item.rating.rate}
                                                                             <span class="text-muted font-bold">(${item.rating.count})</span>
                                                                      </span>
                                                                      </div>
                                                                      <p class="fs-4 my-1 font-bold">$ <span class="">${item.price}</span></p>
                                                                      <button class="btn d-block p-2 text-white font-bold"
                                                                      style="background-color: rgb(85, 55, 255);" id="${item.id}" onclick="fnMyaddToCart(${item.id})"}">Add To Cart</button>
                                                                      </div>
                                                                      </div>
                                                                      </div>`
                                                 )
                                          })
                                   }
                                   function ShowmeMyCart(data) {
                                          $("#ItemWrapper").empty()
                                          $.each(data, function (key, item) {
                                                 console.log("item.length", item.length)
                                                 $("#ItemWrapper").append(`<div class="col-10 mx-auto">
                                                                                    <div class="cardAddTocard mx-auto py-4 px-2 Regular shadow border-none d-flex  gap-5 justify-between">
                                                                                           <div style="width: 19rem; height:15rem; ">
                                                                                           <img src="${item.image}" class="p-3" 
                                                                                                  style="height:100% !important; width:100%" alt="...">
                                                                                           </div>
                                                                                           <div class="w-100">
                                                                                                  <h1 class="font-bold fs-5 my-2">${(item.title)}</h1>
                                                                                           <div class="flex justify-between items-center mt-1">

                                                                                                         <span class="font-bold fs-5">${item.rating.rate}
                                                                                                         <span class="text-muted font-bold">(${item.rating.count})</span>
                                                                                                         </span>
                                                                                                  </div>
                                                                                                  <p class="fs-4 my-1 font-bold">$ <span class="">${item.price}</span></p>
                                                                                                  <div class="d-flex manageItemPlusMinus">
                                                                                                         <button class="btn btn-danger d-block p-3  text-white font-bold" onclick="decreaseItem(${item.id})"
                                                                                                         > -
                                                                                                         </button>
                                                                                                         <button class="btn d-block p-3 border border-none font-bold" id="${item.id}"
                                                                                                          disabled>
                                                                                                         </button>
                                                                                                         <button class="btn btn-success d-block p-3 text-white font-bold"  onclick="increaseItem(${item.id})"
                                                                                                         > +
                                                                                                         </button>
                                                                                           </div>
                                                                                           </div>
                                                                                    </div>
                                                                             </div>`
                                                 )
                                          })
                                   }
                                   //                      
                                   $('[data-search]').on('keyup', data, function (data) {
                                          $("#ItemWrapper").empty()
                                          var searchVal = $(this).val();
                                          var searchArray = new Array()
                                          $.each(data.data, function (key, item) {
                                                 var product_name = (item.title);
                                                 if ((product_name.toLowerCase()).includes((searchVal).toLowerCase())) {
                                                        searchArray.push(item)
                                                 }
                                          })
                                          adddata(searchArray)
                                   });
                                   $(document).on('input', '#slider', function () {
                                          $("#ItemWrapper").empty()
                                          console.log($(this).val());
                                          var myprice = $(this).val();
                                          var sliderArray = new Array()
                                          $.each(data, function (key, item) {
                                                 if (item.price <= myprice) {
                                                        sliderArray.push(item)
                                                 }
                                          })
                                          adddata(sliderArray)
                                   });

                                   $('.checkbox-list').on('change', 'input[type=checkbox]', function () {
                                          var id = $(this).val();
                                          console.log("My id", id)
                                          var RatingArray = new Array()
                                          $.each(data, function (key, item) {
                                                 if (id <= item.rating.rate) {
                                                        RatingArray.push(item)
                                                 }
                                          })
                                          adddata(RatingArray)
                                   });
                                   $('select').on('change', function () {
                                          var CategoryArray = []
                                          var mycurrentCategory = this.value
                                          $.each(data, function (key, item) {
                                                 console.log("this.value", mycurrentCategory)
                                                 if (mycurrentCategory == item.category) {
                                                        CategoryArray.push(item)
                                                 }
                                          })
                                          adddata(CategoryArray)
                                   });
                                   $("#btn-add-to-cart").on("click", function (e) {
                                          event.preventDefault();
                                          ShowmeMyCart(myAddTocart);
                                   })
                                   $("#ItemWrapper button").on("click", function (e) {
                                          event.preventDefault();
                                          console.log("cardAddTocard", $(this).val())
                                   })
                            }
                     })
              })

              var myAddTocart = new Array()
              function fnMyaddToCart(value) {
                     // var myCurrentCardValue = $(this).val()
                     $.each(x, function (key, item) {
                            if (value == item.id) {
                                   Object.assign(item, { qty: 1 })
                                   console.log("New Object", item)
                                   myAddTocart.push(item)
                            }
                     })
                     $(`#${value}`).attr("disabled", "disabled");
                     $(`#${value}`).html("Added to cart")
                     // console.log("mylistIn Cart", myAddTocart)
              }
              function decreaseItem(value) {
                     $.each(x, function (key, item) {
                            if (value == item.id) {
                                   console.log(value +"====" +item.id)
                                   item.qty = item.qty - 1;
                                   // console.log(item)
                            }
                            $(`#${value}`).html(item.qty)
                            
                     })
              }
              function increaseItem(value) {
                     $.each(x, function (key, item) {
                            if (value == item.id) {
                                   item.qty = item.qty + 1;
                                   // console.log(item)
                            }
                            $(`#${value}`).html(item.qty)
                      })
              }
       </script>
</body>
</html>